{"ast":null,"code":"var _jsxFileName = \"/Users/muhammadrenauldi/Development/fa/frontend/memberpage/src/parts/SettingForm.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useRef } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport { useDispatch } from 'react-redux';\nimport propsTypes from 'prop-types';\nimport { toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\nimport Select from 'components/Form/Select';\nimport Input from 'components/Form/Input';\nimport { useSelector } from 'react-redux';\nimport useForm from 'helpers/hooks/useForm';\nimport fieldErrors from 'helpers/fieldErrors';\nimport users from 'constants/api/users';\nimport media from 'constants/api/media';\nimport { populateProfile } from 'store/actions/users';\nimport image2base64 from 'utils/image2base64';\nimport { ReactComponent as DefaultUser } from \"@svgr/webpack?-svgo,+titleProp,+ref!assets/images/default-profile.svg\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction SettingForm({\n  details,\n  history\n}) {\n  _s();\n\n  var _details$name, _details$email, _details$npm, _details$avatar, _details$tft, _details$city_address, _details$ipk, _USERS$npm, _ERRORS$npm, _USERS$name, _ERRORS$name, _ERRORS$email, _ERRORS$city_address, _ERRORS$ipk;\n\n  const dispatch = useDispatch();\n  const addPicture = useRef(null);\n  const USERS = useSelector(state => state.users);\n  const [state, setKey, setState] = useForm({\n    name: (_details$name = details === null || details === void 0 ? void 0 : details.name) !== null && _details$name !== void 0 ? _details$name : '',\n    email: (_details$email = details === null || details === void 0 ? void 0 : details.email) !== null && _details$email !== void 0 ? _details$email : '',\n    npm: (_details$npm = details === null || details === void 0 ? void 0 : details.npm) !== null && _details$npm !== void 0 ? _details$npm : '',\n    avatar: (_details$avatar = details === null || details === void 0 ? void 0 : details.avatar) !== null && _details$avatar !== void 0 ? _details$avatar : '',\n    tft: (_details$tft = details === null || details === void 0 ? void 0 : details.tft) !== null && _details$tft !== void 0 ? _details$tft : '',\n    city_address: (_details$city_address = details === null || details === void 0 ? void 0 : details.city_address) !== null && _details$city_address !== void 0 ? _details$city_address : '',\n    ipk: (_details$ipk = details === null || details === void 0 ? void 0 : details.ipk) !== null && _details$ipk !== void 0 ? _details$ipk : ''\n  });\n  const [errors, setErrors] = useState(null);\n\n  function previewImage(e) {\n    e.persist();\n    image2base64(e.target.files[0]).then(image => {\n      setKey({\n        target: {\n          name: e.target.name,\n          value: image\n        }\n      });\n    });\n  }\n\n  async function submit(e) {\n    e.preventDefault();\n    const payload = {\n      name: state.name,\n      npm: state.npm,\n      email: state.email,\n      avatar: state.avatar,\n      tft: state.tft,\n      city_address: state.city_address,\n      paipk: parseInt(state.ipk)\n    };\n\n    if (state.avatar.indexOf('base64') > -1) {\n      const avatar = await media.upload(state.avatar);\n      payload.avatar = avatar.data.image;\n    }\n\n    users.update(payload).then(res => {\n      toast.success('Profile updated');\n      setState({ ...state,\n        password: ''\n      });\n      setErrors(null);\n      dispatch(populateProfile({ ...details,\n        ...res.data\n      }));\n    }).catch(error => {\n      var _error$response$data$, _error$response, _error$response$data;\n\n      return setErrors((_error$response$data$ = error === null || error === void 0 ? void 0 : (_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) !== null && _error$response$data$ !== void 0 ? _error$response$data$ : 'errors');\n    });\n  }\n\n  const ERRORS = fieldErrors(errors);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"flex flex-col mt-8\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex justify-start items-center -mx-5\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-auto text-center px-5\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"rounded-full overflow-hidden w-24 h-24\",\n            children: state.avatar ? /*#__PURE__*/_jsxDEV(\"img\", {\n              className: \"object-cover w-full h-full\",\n              src: state.avatar,\n              alt: \"Preview\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 102,\n              columnNumber: 9\n            }, this) : /*#__PURE__*/_jsxDEV(DefaultUser, {\n              className: \"fill-indigo-500\",\n              style: {\n                width: 90,\n                height: 90\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 108,\n              columnNumber: 9\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 7\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-full flex flex-col\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-gray-600\",\n            children: \"Add your picture...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 115,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"file\",\n              name: \"avatar\",\n              ref: addPicture,\n              className: \"hidden\",\n              onChange: previewImage\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 117,\n              columnNumber: 8\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => addPicture.current.click(),\n              className: \"bg-gray-300 hover:bg-gray-400 transition-all duration-200 focus:outline-none shadow-inner text-white px-6 py-3 mt-3 rounded-md\",\n              children: \"Browse\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 124,\n              columnNumber: 8\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"flex flex-col mt-8\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center pb-24\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-full md:w-4/6 xl:w-5/12 sm:w-6/12\",\n          children: /*#__PURE__*/_jsxDEV(\"form\", {\n            onSubmit: submit,\n            children: [/*#__PURE__*/_jsxDEV(Input, {\n              value: (_USERS$npm = USERS === null || USERS === void 0 ? void 0 : USERS.npm) !== null && _USERS$npm !== void 0 ? _USERS$npm : state.npm,\n              error: ERRORS === null || ERRORS === void 0 ? void 0 : (_ERRORS$npm = ERRORS.npm) === null || _ERRORS$npm === void 0 ? void 0 : _ERRORS$npm.message,\n              name: \"npm\",\n              onChange: setKey,\n              placeholder: \"Your NPM\",\n              labelName: \"Student Number\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 137,\n              columnNumber: 8\n            }, this), /*#__PURE__*/_jsxDEV(Input, {\n              value: (_USERS$name = USERS === null || USERS === void 0 ? void 0 : USERS.name) !== null && _USERS$name !== void 0 ? _USERS$name : state.name,\n              error: ERRORS === null || ERRORS === void 0 ? void 0 : (_ERRORS$name = ERRORS.name) === null || _ERRORS$name === void 0 ? void 0 : _ERRORS$name.message,\n              name: \"name\",\n              onChange: setKey,\n              placeholder: \"Your Name\",\n              labelName: \"Full Name\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 145,\n              columnNumber: 8\n            }, this), /*#__PURE__*/_jsxDEV(Input, {\n              value: state.email,\n              error: ERRORS === null || ERRORS === void 0 ? void 0 : (_ERRORS$email = ERRORS.email) === null || _ERRORS$email === void 0 ? void 0 : _ERRORS$email.message,\n              name: \"email\",\n              type: \"email\",\n              onChange: setKey,\n              placeholder: \"Your email address\",\n              labelName: \"Email Address\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 153,\n              columnNumber: 8\n            }, this), /*#__PURE__*/_jsxDEV(Input, {\n              value: state.city_address,\n              error: ERRORS === null || ERRORS === void 0 ? void 0 : (_ERRORS$city_address = ERRORS.city_address) === null || _ERRORS$city_address === void 0 ? void 0 : _ERRORS$city_address.message,\n              name: \"city_address\",\n              onChange: setKey,\n              placeholder: \"Your city address\",\n              labelName: \"City Address\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 162,\n              columnNumber: 8\n            }, this), /*#__PURE__*/_jsxDEV(Input, {\n              value: state.ipk,\n              error: ERRORS === null || ERRORS === void 0 ? void 0 : (_ERRORS$ipk = ERRORS.ipk) === null || _ERRORS$ipk === void 0 ? void 0 : _ERRORS$ipk.message,\n              name: \"ipk\",\n              type: \"number\",\n              onChange: setKey,\n              placeholder: \"IPK Value\",\n              labelName: \"IPK\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 170,\n              columnNumber: 8\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              className: \"bg-blue-800 hover:bg-blue-700 transition-all duration-200 focus:outline-none shadow-inner text-white px-6 py-3 mt-4 rounded-md\",\n              children: \"Save Changes\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 180,\n              columnNumber: 8\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 136,\n            columnNumber: 7\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 6\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true);\n}\n\n_s(SettingForm, \"mgFmiWCSrleCa29H4Rj9tPo7AqY=\", false, function () {\n  return [useDispatch, useSelector, useForm];\n});\n\n_c = SettingForm;\nexport default _c2 = withRouter(SettingForm);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"SettingForm\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["/Users/muhammadrenauldi/Development/fa/frontend/memberpage/src/parts/SettingForm.js"],"names":["React","useState","useRef","withRouter","useDispatch","propsTypes","toast","Select","Input","useSelector","useForm","fieldErrors","users","media","populateProfile","image2base64","SettingForm","details","history","dispatch","addPicture","USERS","state","setKey","setState","name","email","npm","avatar","tft","city_address","ipk","errors","setErrors","previewImage","e","persist","target","files","then","image","value","submit","preventDefault","payload","paipk","parseInt","indexOf","upload","data","update","res","success","password","catch","error","response","message","ERRORS","width","height","current","click"],"mappings":"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","sourcesContent":["import React, { useState, useRef } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport { useDispatch } from 'react-redux';\nimport propsTypes from 'prop-types';\n\nimport { toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\n\nimport Select from 'components/Form/Select';\nimport Input from 'components/Form/Input';\n\nimport { useSelector } from 'react-redux';\n\nimport useForm from 'helpers/hooks/useForm';\nimport fieldErrors from 'helpers/fieldErrors';\n\nimport users from 'constants/api/users';\nimport media from 'constants/api/media';\n\nimport { populateProfile } from 'store/actions/users';\n\nimport image2base64 from 'utils/image2base64';\n\nimport { ReactComponent as DefaultUser } from 'assets/images/default-profile.svg';\n\nfunction SettingForm({ details, history }) {\n\tconst dispatch = useDispatch();\n\tconst addPicture = useRef(null);\n\n\tconst USERS = useSelector((state) => state.users);\n\n\tconst [state, setKey, setState] = useForm({\n\t\tname: details?.name ?? '',\n\t\temail: details?.email ?? '',\n\t\tnpm: details?.npm ?? '',\n\t\tavatar: details?.avatar ?? '',\n\t\ttft: details?.tft ?? '',\n\t\tcity_address: details?.city_address ?? '',\n\t\tipk: details?.ipk ?? '',\n\t});\n\n\tconst [errors, setErrors] = useState(null);\n\n\tfunction previewImage(e) {\n\t\te.persist();\n\t\timage2base64(e.target.files[0]).then((image) => {\n\t\t\tsetKey({\n\t\t\t\ttarget: {\n\t\t\t\t\tname: e.target.name,\n\t\t\t\t\tvalue: image,\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\tasync function submit(e) {\n\t\te.preventDefault();\n\n\t\tconst payload = {\n\t\t\tname: state.name,\n\t\t\tnpm: state.npm,\n\t\t\temail: state.email,\n\t\t\tavatar: state.avatar,\n\t\t\ttft: state.tft,\n\t\t\tcity_address: state.city_address,\n\t\t\tpaipk: parseInt(state.ipk),\n\t\t};\n\n\t\tif (state.avatar.indexOf('base64') > -1) {\n\t\t\tconst avatar = await media.upload(state.avatar);\n\t\t\tpayload.avatar = avatar.data.image;\n\t\t}\n\n\t\tusers\n\t\t\t.update(payload)\n\t\t\t.then((res) => {\n\t\t\t\ttoast.success('Profile updated');\n\t\t\t\tsetState({\n\t\t\t\t\t...state,\n\t\t\t\t\tpassword: '',\n\t\t\t\t});\n\t\t\t\tsetErrors(null);\n\t\t\t\tdispatch(\n\t\t\t\t\tpopulateProfile({\n\t\t\t\t\t\t...details,\n\t\t\t\t\t\t...res.data,\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t})\n\t\t\t.catch((error) => setErrors(error?.response?.data?.message ?? 'errors'));\n\t}\n\n\tconst ERRORS = fieldErrors(errors);\n\n\treturn (\n\t\t<>\n\t\t\t<section className='flex flex-col mt-8'>\n\t\t\t\t<div className='flex justify-start items-center -mx-5'>\n\t\t\t\t\t<div className='w-auto text-center px-5'>\n\t\t\t\t\t\t<div className='rounded-full overflow-hidden w-24 h-24'>\n\t\t\t\t\t\t\t{state.avatar ? (\n\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\tclassName='object-cover w-full h-full'\n\t\t\t\t\t\t\t\t\tsrc={state.avatar}\n\t\t\t\t\t\t\t\t\talt='Preview'\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<DefaultUser\n\t\t\t\t\t\t\t\t\tclassName='fill-indigo-500'\n\t\t\t\t\t\t\t\t\tstyle={{ width: 90, height: 90 }}></DefaultUser>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className='w-full flex flex-col'>\n\t\t\t\t\t\t<span className='text-gray-600'>Add your picture...</span>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\ttype='file'\n\t\t\t\t\t\t\t\tname='avatar'\n\t\t\t\t\t\t\t\tref={addPicture}\n\t\t\t\t\t\t\t\tclassName='hidden'\n\t\t\t\t\t\t\t\tonChange={previewImage}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tonClick={() => addPicture.current.click()}\n\t\t\t\t\t\t\t\tclassName='bg-gray-300 hover:bg-gray-400 transition-all duration-200 focus:outline-none shadow-inner text-white px-6 py-3 mt-3 rounded-md'>\n\t\t\t\t\t\t\t\tBrowse\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</section>\n\t\t\t<section className='flex flex-col mt-8'>\n\t\t\t\t<div className='flex items-center pb-24'>\n\t\t\t\t\t<div className='w-full md:w-4/6 xl:w-5/12 sm:w-6/12'>\n\t\t\t\t\t\t<form onSubmit={submit}>\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\tvalue={USERS?.npm ?? state.npm}\n\t\t\t\t\t\t\t\terror={ERRORS?.npm?.message}\n\t\t\t\t\t\t\t\tname='npm'\n\t\t\t\t\t\t\t\tonChange={setKey}\n\t\t\t\t\t\t\t\tplaceholder='Your NPM'\n\t\t\t\t\t\t\t\tlabelName='Student Number'\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\tvalue={USERS?.name ?? state.name}\n\t\t\t\t\t\t\t\terror={ERRORS?.name?.message}\n\t\t\t\t\t\t\t\tname='name'\n\t\t\t\t\t\t\t\tonChange={setKey}\n\t\t\t\t\t\t\t\tplaceholder='Your Name'\n\t\t\t\t\t\t\t\tlabelName='Full Name'\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\tvalue={state.email}\n\t\t\t\t\t\t\t\terror={ERRORS?.email?.message}\n\t\t\t\t\t\t\t\tname='email'\n\t\t\t\t\t\t\t\ttype='email'\n\t\t\t\t\t\t\t\tonChange={setKey}\n\t\t\t\t\t\t\t\tplaceholder='Your email address'\n\t\t\t\t\t\t\t\tlabelName='Email Address'\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\tvalue={state.city_address}\n\t\t\t\t\t\t\t\terror={ERRORS?.city_address?.message}\n\t\t\t\t\t\t\t\tname='city_address'\n\t\t\t\t\t\t\t\tonChange={setKey}\n\t\t\t\t\t\t\t\tplaceholder='Your city address'\n\t\t\t\t\t\t\t\tlabelName='City Address'\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\tvalue={state.ipk}\n\t\t\t\t\t\t\t\terror={ERRORS?.ipk?.message}\n\t\t\t\t\t\t\t\tname='ipk'\n\t\t\t\t\t\t\t\ttype='number'\n\t\t\t\t\t\t\t\tonChange={setKey}\n\t\t\t\t\t\t\t\tplaceholder='IPK Value'\n\t\t\t\t\t\t\t\tlabelName='IPK'\n\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\ttype='submit'\n\t\t\t\t\t\t\t\tclassName='bg-blue-800 hover:bg-blue-700 transition-all duration-200 focus:outline-none shadow-inner text-white px-6 py-3 mt-4 rounded-md'>\n\t\t\t\t\t\t\t\tSave Changes\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</form>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</section>\n\t\t</>\n\t);\n}\n\nexport default withRouter(SettingForm);\n"]},"metadata":{},"sourceType":"module"}